!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports["photolayout.min"]=i():t["photolayout.min"]=i()}(this,function(){return function(t){function i(e){if(n[e])return n[e].exports;var o=n[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var n={};return i.m=t,i.c=n,i.p="",i(0)}([function(t,i,n){"use strict";function e(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var o,r=n(8),s=e(r),u=n(12),h=e(u),f=n(11),a=(e(f),n(10)),c=e(a);o={Layout:s["default"],ResponsiveLayout:h["default"],Configuration:c["default"]},i["default"]=o},,,,,,,,function(t,i,n){"use strict";function e(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var o,r=n(!function(){var t=new Error('Cannot find module "./line.coffee"');throw t.code="MODULE_NOT_FOUND",t}()),s=e(r),u=n(10),h=e(u),f=n(11),a=e(f);o=function(){function t(t){t instanceof h["default"]?this._config=t:this._config=new h["default"](t),console.log(this._config),this._current_line=new s["default"](this._config,this),this._lines=[this._current_line]}return t.prototype.add=function(t){var i,n,e;if(t instanceof Array){for(i=0,n=t.length;n>i;i++)e=t[i],this.add(e);return this}return this._current_line.accept(t)?this._current_line.add(t):(this._current_line=new s["default"](this._config,this),this._lines.push(this._current_line),this._current_line.add(t)),this},t.prototype.getItems=function(t,i){var n,e,o,r,s,u,h,f,a,c,l,_,d,g,p,m,y;if(null==t&&(t=0),r=[],d=0,0===t&&null==i){for(g=this._lines,e=0,f=g.length;f>e;e++){for(_=g[e],p=_.getItems(d),s=0,a=p.length;a>s;s++)o=p[s],r.push(o);d+=o.h+this._config.margin()}return r}for(raise("ERROR "),m=this._lines,u=0,c=m.length;c>u;u++)if(_=m[u],n=_.height(),t>d)d+=n+this._config.margin();else{for(y=_.getItems(d),h=0,l=y.length;l>h;h++)o=y[h],r.push(o);if(d+=n+this._config.margin(),null!=i&&d>=i)break}return r},t.prototype.height=function(){var t,i,n,e,o;for(t=0,o=this._lines,i=0,n=o.length;n>i;i++)e=o[i],t+=e.height();return t+=(this._lines.length-1)*this._config.margin()},t.prototype.min_max_line_ratio=function(){var t,i,n,e,o,r;for(o=e=this._lines[0].ratio(),r=this._lines,t=0,i=r.length;i>t;t++)n=r[t],o=Math.min(n.ratio(),o),e=Math.max(n.ratio(),e);return[o,e]},t.prototype.css=function(){return(new a["default"]).add_rules(this._config.selector(),{"float":"left",margin:"0 "+this._config.margin()+"% "+this._config.margin()+"% 0"}).add_block(this.css_for_items()).css()},t.prototype.css_for_items=function(){var t,i,n,e,o,r,s,u,h,f,c,l;for(t=new a["default"],i=[],f=this._lines,n=0,r=f.length;r>n;n++){for(u=f[n],h=[],c=u.getItems(),o=0,s=c.length;s>o;o++)e=c[o],l=this._config.selector()+e.o.id,t.add_rules(l,{width:e.w+"%"}),h.push(l);t.add_rules(h.join(","),{"padding-top":u.height()+"%"}),i.push(l)}return this._config.margin()>0&&t.add_rules(i.join(","),{"margin-right":0}),t.css()},t}(),i["default"]=o},,function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;n=function(){function t(t){this._config=t}return t.prototype.zoom=function(){return this._config.zoom||1},t.prototype.line_height=function(){return null==this._config.line_height?200:this._config.line_height},t.prototype.margin=function(){return null==this._config.margin?5:1*this._config.margin},t.prototype.tolerance=function(){return null==this._config.tolerance?.3:1*this._config.tolerance},t.prototype.max_width=function(){return null==this._config.max_width?2500:1*this._config.max_width},t.prototype.min_width=function(){return null==this._config.min_width?200:1*this._config.max_width},t.prototype.selector=function(){return".i"},t.prototype.to_hash=function(){return{line_height:this.line_height(),margin:this.margin(),tolerance:this.tolerance(),max_width:this.max_width(),min_width:this.min_width(),selector:this.selector()}},t.prototype.derivate=function(i){var n,e,o;n=this.to_hash();for(e in i)o=i[e],n[e]=o;return new t(n)},t}(),i["default"]=n},function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;n=function(){function t(){this._css=""}return t.prototype.add_block=function(t,i){return null!=i?this._css+=i+"{"+t+"}":this._css+=t,this},t.prototype.add_rules=function(t,i){var n,e,o;n="";for(e in i)o=i[e],n+=e+":"+o+";";return this.add_block(n,t),this},t.prototype.css=function(){return this._css},t}(),i["default"]=n},function(t,i,n){"use strict";function e(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var o,r=n(8),s=e(r),u=n(11),h=e(u),f=n(10),a=e(f);o=function(){function t(t){t instanceof a["default"]?this._config=t:this._config=new a["default"](t),this._photos=[],this._layouts=void 0}return t.prototype.getLayouts=function(){var t,i,n,e,o,r;if(null!=this._layouts)return this._layouts;for(this._layouts={},r=this._config.max_width();r>this._config.min_width();)console.log(this._config.to_hash()),console.log(this._config.derivate({zoom:100}).to_hash()),t=new s["default"](this._config.derivate({zoom:this._config.line_height()/r,margin:this._config.margin()/r*100})),t.add(this._photos),this._layouts[r]=t,e=t.min_max_line_ratio(),n=e[0],i=e[1],o=r-r*this._config.tolerance(),r-=Math.round(o/n);return this._layouts},t.prototype.add=function(t){var i,n,e;if(t instanceof Array){for(i=0,n=t.length;n>i;i++)e=t[i],this.add(e);return this}return this._photos.push(t),this._layouts=void 0,this},t.prototype.layout_for=function(t){return layout},t.prototype.breakpoints=function(){return Object.keys(this.getLayouts()).sort(function(t,i){return i-t})},t.prototype.css=function(){var t,i,n,e,o;for(t=new h["default"],e=this.breakpoints(),i=0,n=e.length;n>i;i++)o=e[i],t.add_block(this._layouts[o].css(),"@media (max-width: "+o+"px)");return t.css()},t}(),i["default"]=o}])});